clc;
close all;
clearvars;

% dpath='C:\Users\spegwal\Downloads\Saurabh\MAT_REPO\Repository\SPegwal\Calibration_code\REACH calibration\REACH-RXcal\data\2023_12_11_14_32\';
dpath='C:\Users\spegwal\Downloads\Saurabh\MAT_REPO\Repository\SPegwal\Calibration_code\REACH calibration\REACH-RXcal\data\calibration\';
d = REACHcal(dpath);

% dpath='C:\Users\spegwal\Downloads\Saurabh\MAT_REPO\Repository\SPegwal\Calibration_code\REACH calibration\REACH-RXcal\data\2024_01_07_19_00\';
% dpath='C:\Users\spegwal\Downloads\Saurabh\MAT_REPO\Repository\SPegwal\Calibration_code\REACH calibration\REACH-RXcal\data\2024_01_09_19_00\';
% d = REACHcal_1(dpath);

% 
d.errorFuncType = 'RIA';
d.errorFuncNorm = 'mean';
% 
d1 = d.optimConfig('all');
d1 = d1.fitParams;

figure (1)
d1.plotAllS11(3,{'r','k'});
% 
% figure (2)
% d1.plotAllParameters('r*');
% leg = {'91-par', '80-par'};
% % 
% % % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core
% % % switches---91par
% % 
% r36.vals = [3.20068      16.2845      3.23367       36.369];
% r27.vals = [3.13726      16.1917      3.63759      26.7007];
% r69.vals = [2.73429      13.5103      2.64008      70.3619];
% r91.vals = [3.13986      14.6212      2.61472      94.4196];
% rOpen.vals = [1.00264      55.3209      2.35122      0.99344];
% rShort.vals = [10.6059      9.89723      16.1126     0.338702];
% r10.vals = [5.29749      13.5101      23.2298      10.4562];
% r250.vals = [2.814001      14.41159       1.37217      253.1697];
% rCold.vals = [1.8299      8.07943       1.1557      50.0393];
% rHot.vals = [2.69952      11.1308      1.86273      50.6434];
% r25.vals = [3.48111      11.5135      5.92067      24.3128];
% r100.vals = [3.102889      28.97095      1.652871         103.8];
% ms1.vals = [49.6089      11.7725            1            0      10.6576];
% ms3.vals = [50.1063      12.8738            1            0       4.6965];
% ms4.vals = [50.0683      12.8007            1            0       4.9615];
% mts.vals = [56.8425      43.8846            1            0         51.5];
% sr_mtsj1.vals = [48.96162      136.8333      2.097265   0.000252867      4.385029];
% sr_mtsj2.vals = [48.06489      124.7121      2.097309  0.0002469323     0.8843756];
% sr_ms1j2.vals = [51.60521      121.3816      2.105305  0.0002500194      1.006136];
% c2.vals = [49.1719      1.97618  -0.00658231      1.48445  5.49779e-05   0.00866244   0.00651349     0.169129];
% c10.vals = [49.645      9.96658  -0.00984547      1.43237  -0.00163294   0.00565294     0.295739     0.281757];
% la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% d = REACHcal(dpath,'r36',r36,'r27',r27,'r69',r69,'r91',r91,...
%                 'rOpen',rOpen,'rShort',rShort,'r10',r10,'r250',r250,...
%                 'rCold',rCold,'rHot',rHot,'r25',r25,'r100',r100,...
%                 'c2',c2,'c10',c10,...
%                 'ms1',ms1,'ms3',ms3,'ms4',ms4','mts',mts,...
%                 'sr_mtsj2',sr_mtsj2,'sr_mtsj1',sr_mtsj1,'sr_ms1j2',sr_ms1j2);
% 
% d.errorFuncType = 'RIA';
% d.errorFuncNorm = 'mean';
% % figure(2)
% % d.plotAllParameters
% figure(1)
% custom = {'r69','ms3','ms1','sr_mtsj2'};
% d.plotAllTemperatures('b');hold on;
% hold on;
% % 
% % figure(2)
% % legends = ['Nom'];
% % d.plotAllS11([],'r');
% % % hold on;
% 
% figure (3)
% d.plotAllParameters('r*');
% % 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No slopes (6 par fixed to zero) for c2 & c10 --- 85par
% % 
% r36.vals = [3.8904      19.1138      4.03316      36.3589];
% r27.vals = [3.75892      18.8431      4.60398      26.7262];
% r69.vals = [3.91425      18.9389      3.15266      70.2585];
% r91.vals = [4.21639      19.6977      2.91076      94.2191];
% rOpen.vals = [11.1737       53.254      1.03622     0.999956];
% rShort.vals = [0.536281      32.3913      23.6265     0.441635];
% r10.vals = [6.39934      28.2316      6.23873      10.4616];
% r250.vals = [8.903189       40.1077      3.662619      246.5002];
% rCold.vals = [1.78652       7.3881     0.949004      50.0608];
% rHot.vals = [2.47834      10.4007      1.72108      50.6557];
% r25.vals = [3.95859      13.6419      7.03851      24.4307];
% r100.vals = [3.614118      30.41822      1.854387      103.3947];
% ms1.vals = [49.3009      12.1929            1            0       6.7684];
% ms3.vals = [50.0623      12.9591            1            0      4.77149];
% ms4.vals = [50.121      12.8692            1            0      4.97989];
% mts.vals = [56.6549       45.422            1            0      46.5353];
% sr_mtsj1.vals = [48.88097      129.6131      2.089817  0.0002511616      3.057622];
% sr_mtsj2.vals = [48.14228      123.9675      2.092672  0.0002490517      1.615528];
% sr_ms1j2.vals = [51.36774      121.0413      2.102303  0.0002500203      1.007464];
% c2.vals = [49.1899      1.97167            0      1.48167            0   0.00937097            0     0.200311];
% c10.vals = [49.7085      9.93295            0      1.41109            0   0.00532222            0     0.373192];
% la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% d = REACHcal(dpath,'r36',r36,'r27',r27,'r69',r69,'r91',r91,...
%                 'rOpen',rOpen,'rShort',rShort,'r10',r10,'r250',r250,...
%                 'rCold',rCold,'rHot',rHot,'r25',r25,'r100',r100,...
%                 'c2',c2,'c10',c10,...
%                 'ms1',ms1,'ms3',ms3,'ms4',ms4','mts',mts,...
%                 'sr_mtsj2',sr_mtsj2,'sr_mtsj1',sr_mtsj1,'sr_ms1j2',sr_ms1j2);
% 
% d.errorFuncType = 'RIA';
% d.errorFuncNorm = 'mean';
% % % figure(2)
% % % d.plotAllParameters
% figure(1)
% d.plotAllTemperatures('k',leg(1:2));hold on;
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No Rprime slope (2 par fixed to zero) for c2 & c10 --- 89par
% % r36.vals = [3.08844      15.8129      3.08448      36.3767];
% % r27.vals = [3.00192      15.6837      3.33704      26.7218];
% % r69.vals = [2.67308      13.2451       2.5816      70.3218];
% % r91.vals = [3.13054      14.5944      2.52744      94.3272];
% % rOpen.vals = [1.10477      55.9204      2.34512      1.00667];
% % rShort.vals = [9.87026      10.1622      18.3935     0.338133];
% % r10.vals = [5.77633      13.9382      25.8159      10.4714];
% % r250.vals = [2.735175      13.21772      1.525869      253.1578];
% % rCold.vals = [1.74715      7.44346     0.986616      50.0352];
% % rHot.vals = [2.82994      11.6752      1.95978      50.6408];
% % r25.vals = [3.61234      11.9608      6.23871      24.3579];
% % r100.vals = [3.096965      27.68801      1.624644      103.5816];
% % ms1.vals = [49.556      11.7558            1            0      9.42184];
% % ms3.vals = [50.0941      12.9349            1            0      4.70036];
% % ms4.vals = [50.1066      12.9224            1            0      4.93499];
% % mts.vals = [56.9012      43.5153            1            0      51.5314];
% % sr_mtsj1.vals = [48.95435      136.1462      2.100757  0.0002533521      3.811004];
% % sr_mtsj2.vals = [48.06942      124.4731      2.097542  0.0002471013     0.8326097];
% % sr_ms1j2.vals = [51.62142      121.3842      2.104988  0.0002500202        1.0038];
% % c2.vals = [49.1628      1.97784  -0.00666095      1.48618   5.6976e-05   0.00877988            0     0.185818];
% % c10.vals = [49.6387      9.96948  -0.00984966      1.43156  -0.00163668   0.00725888            0     0.193235];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No tanD slope (2 par fixed to zero) for c2 & c10 --- 89par
% % 
% % r36.vals = [3.06867      15.6992      3.11402      36.4064];
% % r27.vals = [3.07299        15.81      3.74981      26.7446];
% % r69.vals = [2.72197      13.7291      2.57298      70.3259];
% % r91.vals = [3.00861      14.3808      2.52882      94.3174];
% % rOpen.vals = [5.91821      54.1737      6.53759      1.00837];
% % rShort.vals = [8.50701      31.3897       18.191     0.363339];
% % r10.vals = [8.40162      32.5416      11.3888      10.1816];
% % r250.vals = [0.187778      19.00427      12.43736      257.7811];
% % rCold.vals = [1.61942      6.53234      0.74943      50.0571];
% % rHot.vals = [2.53068      10.3603      1.70016      50.6553];
% % r25.vals = [3.15501      11.3213      5.09816      24.3451];
% % r100.vals = [3.203643      28.23537      1.675803      103.7096];
% % ms1.vals = [49.6413      11.8815            1            0      9.69166];
% % ms3.vals = [50.1294      13.0323            1            0      4.72232];
% % ms4.vals = [50.1035      13.1383            1            0      4.92208];
% % mts.vals = [56.6191      44.5737            1            0      50.0759];
% % sr_mtsj1.vals = [48.95479      134.6669      2.093341  0.0002521399      3.813224];
% % sr_mtsj2.vals = [48.09759      124.0414       2.09683  0.0002482303      1.220164];
% % sr_ms1j2.vals = [51.52409      121.4485      2.103637   0.000250019      1.008856];
% % c2.vals = [49.1753      1.97999  -0.00724226      1.48777            0   0.00831958   0.00567114     0.177167];
% % c10.vals = [49.4805      9.93317   -0.0163265      1.41191            0   0.00398712      0.21649     0.444273];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon slope (2 par fixed to zero) for c2 & c10 --- 89par
% % 
% % r36.vals = [4.0569      19.4648      3.61264      36.2748];
% % r27.vals = [4.13088      20.1164      4.56632      26.6437];
% % r69.vals = [3.89311      18.2711      3.40037       70.228];
% % r91.vals = [3.96782      17.8712      3.44551      94.3168];
% % rOpen.vals = [10.8897      53.1942     0.955822     0.982784];
% % rShort.vals = [0.474402      31.4705      23.2284     0.454247];
% % r10.vals = [6.15339       27.214      3.79507      10.4822];
% % r250.vals = [8.600201       39.3723      3.592505      247.2136];
% % rCold.vals = [1.76807      7.55989      1.00961      50.0168];
% % rHot.vals = [2.56938      10.7804      1.81749      50.6201];
% % r25.vals = [3.73279      12.1667       6.5093      24.3333];
% % r100.vals = [3.269058      30.19821      1.729915      103.6315];
% % ms1.vals = [49.2825       12.352            1            0      5.46399];
% % ms3.vals = [50.0853      12.9502            1            0      4.75861];
% % ms4.vals = [50.0818       12.985            1            0      4.95055];
% % mts.vals = [56.3202      47.1712            1            0      51.7283];
% % sr_mtsj1.vals = [48.90876      132.3673      2.111498  0.0002510803      3.003587];
% % sr_mtsj2.vals = [48.08056      124.0363      2.117741  0.0002477066     0.9240172];
% % sr_ms1j2.vals = [51.44888      121.1984      2.101967  0.0002499875         1.004];
% % c2.vals = [49.1598      1.96206            0      1.47367  2.07362e-05   0.00921786   0.00611652      0.17925];
% % c10.vals = [49.6694      9.93158            0      1.41054  -0.00171536    0.0060935     0.273987      0.25043];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD slope (4 par fixed to zero) for c2 & c10 --- 87par
% %
% % r36.vals = [3.94799      19.2683       3.9585       36.338];
% % r27.vals = [3.8855      19.2113      4.63557      26.6981];
% % r69.vals = [3.90341       18.805      3.22919      70.2622];
% % r91.vals = [4.2674      19.9687      3.02517      94.2628];
% % rOpen.vals = [11.0601      53.3713      1.09785      1.00143];
% % rShort.vals = [0.531581      32.2769      22.8454      0.43978];
% % r10.vals = [6.39779      28.1727      6.34374      10.4521];
% % r250.vals = [8.76911      39.18062      3.721577      246.7159];
% % rCold.vals = [1.80653      7.39174     0.940049      50.0518];
% % rHot.vals = [2.75164      11.6313      1.95678      50.6548];
% % r25.vals = [4.02477      14.1246      7.18101      24.3852];
% % r100.vals = [3.710574      29.89832      1.876414      103.5411];
% % ms1.vals = [49.1823      12.9483            1            0      7.96107];
% % ms3.vals = [50.0769      12.9487            1            0      4.77104];
% % ms4.vals = [50.0813      12.7985            1            0      4.97568];
% % mts.vals = [56.7597      45.5627            1            0       46.681];
% % sr_mtsj1.vals = [48.83252      126.5938       2.09053   0.000250875      3.803389];
% % sr_mtsj2.vals = [48.14586      124.0789      2.093112  0.0002489984      1.557761];
% % sr_ms1j2.vals = [51.40289      121.0678      2.102479  0.0002500188      1.002545];
% % c2.vals = [49.1796      1.97212            0      1.48175            0   0.00904823   0.00538384     0.192368];
% % c10.vals = [49.7027      9.93432            0      1.41161            0   0.00395547      0.25149      0.44769];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No tanD Rprime slope (4 par fixed to zero) for c2 & c10 --- 87par
% %
% % r36.vals = [3.15549      16.1677      3.31222      36.3886];
% % r27.vals = [3.17294      16.3639      4.23975      26.7243];
% % r69.vals = [2.58473      12.8577      2.57166      70.3189];
% % r91.vals = [2.86934      13.3433      2.61555      94.3271];
% % rOpen.vals = [5.91328      54.5431      6.42503      1.01223];
% % rShort.vals = [8.5101      31.0619      18.7634     0.360898];
% % r10.vals = [8.39361      32.4246      13.3394      10.1937];
% % r250.vals = [0.1810439      18.73201      12.34312      257.6319];
% % rCold.vals = [1.58954      6.52618      0.78124      50.0696];
% % rHot.vals = [2.5032       10.113      1.63309      50.6521];
% % r25.vals = [3.04227      11.2515      4.82196      24.3792];
% % r100.vals = [3.237376      28.01474      1.691283      103.6015];
% % ms1.vals = [49.7647      12.2762            1            0      9.68102];
% % ms3.vals = [50.1311      13.0074            1            0      4.73087];
% % ms4.vals = [50.3753      13.0688            1            0      4.92938];
% % mts.vals = [56.5143      44.7353            1            0      50.0462];
% % sr_mtsj1.vals = [48.96269      134.2343      2.085491  0.0002520556      3.265999];
% % sr_mtsj2.vals = [48.09656       123.803      2.088134  0.0002482421      1.175757];
% % sr_ms1j2.vals = [51.51977      121.4589       2.10324  0.0002500151      1.002847];
% % c2.vals = [49.166      1.98057  -0.00769357       1.4869            0   0.00881544            0     0.185298];
% % c10.vals = [49.493      9.93427   -0.0162423      1.41234            0   0.00516369            0     0.378434];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon Rprime slope (4 par fixed to zero) for c2 & c10 --- 87par
% %
% % r36.vals = [4.04616      19.6354      4.00761      36.2778];
% % r27.vals = [4.07566       20.004      5.23422      26.6388];
% % r69.vals = [4.01207       19.012      3.27196      70.2656];
% % r91.vals = [4.38507      20.1228      3.08012      94.3667];
% % rOpen.vals = [10.8603      53.3016     0.975278     0.987252];
% % rShort.vals = [0.473476      31.4774      23.0243     0.454958];
% % r10.vals = [6.1525      27.2212      3.70504      10.4843];
% % r250.vals = [8.48173      38.60192       3.67203      247.4577];
% % rCold.vals = [1.84173      7.95894      1.10456      50.0186];
% % rHot.vals = [2.62996      11.0008      1.84783      50.6235];
% % r25.vals = [3.54501      12.0715      6.05077      24.3263];
% % r100.vals = [3.324244      29.86878      1.737591      103.6764];
% % ms1.vals = [49.1236      12.7862            1            0      5.66897];
% % ms3.vals = [50.0747      12.9348            1            0      4.77031];
% % ms4.vals = [50.0125      12.9301            1            0      4.91317];
% % mts.vals = [56.3971      46.6801            1            0       51.573];
% % sr_mtsj1.vals = [48.90724      133.3172      2.082851  0.0002527122      3.053261];
% % sr_mtsj2.vals = [48.08717      123.6434      2.089575  0.0002487928      1.230165];
% % sr_ms1j2.vals = [51.46906      121.0235      2.104069  0.0002500344       1.00367];
% % c2.vals = [49.162      1.96553            0      1.47659  7.48385e-05   0.00945869            0     0.173996];
% % c10.vals = [49.6809      9.93219            0       1.4108  -0.00169978   0.00754415            0     0.159286];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10 --- 87par
% %
% % r36.vals = [3.19972       16.223      2.80904      36.3536];
% % r27.vals = [3.1605      16.6072      3.11193      26.6911];
% % r69.vals = [3.20337      15.3175      2.81821      70.3142];
% % r91.vals = [4.06123      19.0467      2.59709      94.3048];
% % rOpen.vals = [0.834349      56.1208       2.3509       1.0078];
% % rShort.vals = [11.1976      9.50886      19.7451     0.338899];
% % r10.vals = [6.01403       13.427      26.3709      10.4624];
% % r250.vals = [3.018039       17.7011      1.070937      253.1465];
% % rCold.vals = [1.78335      7.67145      1.04538      50.0225];
% % rHot.vals = [2.72755      11.2751      1.89411      50.6321];
% % r25.vals = [3.84305      12.2078      6.74528       24.395];
% % r100.vals = [3.043512      27.58367      1.609503      103.4045];
% % ms1.vals = [49.7094      11.5059            1            0      8.08994];
% % ms3.vals = [50.0829      12.9093            1            0      4.68526];
% % ms4.vals = [50.1365      12.8775            1            0      4.92017];
% % mts.vals = [56.761      44.0982            1            0      51.7166];
% % sr_mtsj1.vals = [48.95603      136.1625      2.104976  0.0002533454      2.931526];
% % sr_mtsj2.vals = [48.0654      124.8791      2.098487  0.0002472991     0.8683425];
% % sr_ms1j2.vals = [51.5803      121.5147      2.102949  0.0002500153     0.9839338];
% % c2.vals = [49.1595      1.97082            0      1.48054            0   0.00983538            0     0.181391];
% % c10.vals = [49.6383      9.96303  -0.00994284      1.43411  -0.00167409   0.00729733            0     0.200071];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10 
% % same length for MS-3/4--- 86 par fixed
% % r36.vals = [3.74519      18.3062      3.16062      35.8217];
% % r27.vals = [3.63259      18.5796      3.19869      26.0575];
% % r69.vals = [3.52741       16.204       3.2785      70.7357];
% % r91.vals = [4.63377      20.7081      3.06685      95.8283];
% % rOpen.vals = [0.817371      56.4359      2.49036      1.00479];
% % rShort.vals = [11.6323      9.70817      17.3043     0.326155];
% % r10.vals = [6.89026      13.8958      29.8994      10.3921];
% % r250.vals = [2.898798      15.21882       1.30018      251.6414];
% % rCold.vals = [1.46038      7.78376      1.32967      49.8539];
% % rHot.vals = [3.83224      14.1083      2.35973      50.4883];
% % r25.vals = [3.91312       7.5234      5.38222      23.8305];
% % r100.vals = [1.790528      33.08148      1.623254      105.0824];
% % ms1.vals = [54.6185      23.0381            1            0      22.1542];
% % ms3.vals = [50.0811      12.9041            1            0      4.83684];
% % ms4.vals = [49.9874      12.9041            1            0      4.90358];
% % mts.vals = [58.9902      48.8164            1            0      52.5384];
% % sr_mtsj1.vals = [48.89826      148.1577         2.123  0.0002560964      7.303921];
% % sr_mtsj2.vals = [46.66916      123.1294      2.069774  0.0002441432     0.5400206];
% % sr_ms1j2.vals = [52.66815      120.2653      2.100207  0.0002500272     0.9847832];
% % c2.vals = [48.9361      1.94635            0      1.45911            0    0.0107632            0     0.260008];
% % c10.vals = [49.3124      9.95984   -0.0102296      1.42715  -0.00163817   0.00726006            0    0.0839996];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10 
% % same length for MS-3/4; same epsilon for 2 semirigid--- 85 par fixed
% 
% % r36.vals = [3.78883      18.6763      3.44567      35.8178];
% % r27.vals = [3.63006      18.8371      3.62136      26.0537];
% % r69.vals = [3.60469      16.4592      3.23627      70.7529];
% % r91.vals = [4.74383      21.2248      2.99399      95.8653];
% % rOpen.vals = [0.784133      56.4693      2.45662      1.00268];
% % rShort.vals = [11.9538      9.51643      17.4308     0.326364];
% % r10.vals = [6.79782      13.6979      29.4322      10.3988];
% % r250.vals = [3.080972      17.73344       1.09025      251.5443];
% % rCold.vals = [1.40518      7.35332       1.2146      49.8513];
% % rHot.vals = [3.90229      14.3749      2.40508      50.4889];
% % r25.vals = [3.80723      7.46265      5.29669      23.8526];
% % r100.vals = [1.795936      32.78385       1.61151      104.9951];
% % ms1.vals = [54.6224      22.6549            1            0      22.1689];
% % ms3.vals = [50.047      12.9244            1            0      4.82723];
% % ms4.vals = [50.0093      12.9244            1            0      4.89032];
% % mts.vals = [58.9004      48.8738            1            0      52.5587];
% % sr_mtsj1.vals = [48.89362      148.1498      2.102134  0.0002551481      7.002008];
% % sr_mtsj2.vals = [46.71722      122.9346      2.102134  0.0002434768     0.5298923];
% % sr_ms1j2.vals = [52.69299       120.258      2.101287  0.0002500524      1.009728];
% % c2.vals = [48.9389      1.94695            0      1.45922            0    0.0111946            0     0.267078];
% % c10.vals = [49.3272      9.96066   -0.0101582      1.42722  -0.00164972   0.00727815            0     0.086595];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10 
% % same length for MS-3/4; same epsilon, tanD for 2 semirigid--- 84 par fixed
% 
% r36.vals = [3.73962      18.2172      3.08095      35.8397];
% r27.vals = [3.68181      18.6833      3.21808      26.0769];
% r69.vals = [3.61026      16.6448        3.307       70.696];
% r91.vals = [4.6445      20.9059       3.0993      95.7397];
% rOpen.vals = [0.813824      56.4605      2.43513      1.00022];
% rShort.vals = [11.9808      9.50945      17.5103     0.325169];
% r10.vals = [6.66977      13.6341      28.8534      10.3924];
% r250.vals = [3.057469      17.62155      1.110698      251.5494];
% rCold.vals = [1.34071      7.28377      1.23796      49.8486];
% rHot.vals = [4.03643      14.6118      2.43451      50.4893];
% r25.vals = [4.12014      7.18029      5.28234      23.8376];
% r100.vals = [1.608949      32.97627      1.618181      105.0262];
% ms1.vals = [54.6433      23.3023            1            0      22.0659];
% ms3.vals = [50.0992       12.913            1            0      4.81605];
% ms4.vals = [50.0305       12.913            1            0      4.86217];
% mts.vals = [58.5699       50.354            1            0      52.5706];
% sr_mtsj1.vals = [48.90246       148.784        2.1036  0.0002500308      6.505605];
% sr_mtsj2.vals = [46.69156      123.2772        2.1036  0.0002500308     0.5386878];
% sr_ms1j2.vals = [52.90322      120.2505      2.100872  0.0002500306      1.001053];
% c2.vals = [48.9328      1.94465            0      1.45694            0    0.0105562            0      0.25734];
% c10.vals = [49.3066      9.96078   -0.0101419      1.42629  -0.00164204   0.00726735            0    0.0861021];
% la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% 
% 
% d = REACHcal(dpath,'r36',r36,'r27',r27,'r69',r69,'r91',r91,...
%                 'rOpen',rOpen,'rShort',rShort,'r10',r10,'r250',r250,...
%                 'rCold',rCold,'rHot',rHot,'r25',r25,'r100',r100,...
%                 'c2',c2,'c10',c10,...
%                 'ms1',ms1,'ms3',ms3,'ms4',ms4','mts',mts,...
%                 'sr_mtsj2',sr_mtsj2,'sr_mtsj1',sr_mtsj1,'sr_ms1j2',sr_ms1j2);
% 
% d.errorFuncType = 'RIA';
% d.errorFuncNorm = 'mean';
% % % figure(2)
% % % d.plotAllParameters
% 
% figure(1)
% % legend(leg);
% d.plotAllTemperatures('b',leg);hold on;


% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10 --- 87par
% % same length for MS-3/4; same epsilon, tanD for 2 semirigid
% % same epsilon for c2-c10--- 83 par fixed
% % 
% % r36.vals = [3.78203      18.3419      2.95581      35.8297];
% % r27.vals = [3.77245      19.1516       3.3085      26.0682];
% % r69.vals = [3.53676      16.1722      3.39022      70.6951];
% % r91.vals = [4.38389      19.0001      3.29464      95.7518];
% % rOpen.vals = [0.905277      55.2911      2.40276      1.00879];
% % rShort.vals = [11.7195      9.60498      13.9991     0.326093];
% % r10.vals = [5.87139      13.4312      25.4144      10.3765];
% % r250.vals = [2.908552      15.21966      1.268142      251.6691];
% % rCold.vals = [1.47936       7.9446      1.37567      49.8428];
% % rHot.vals = [3.88388       14.253      2.38971      50.4835];
% % r25.vals = [4.22958      7.79813      5.75824      23.8611];
% % r100.vals = [1.764396      33.46037      1.646901      104.9168];
% % ms1.vals = [54.6295      23.0725            1            0      21.9069];
% % ms3.vals = [50.0576      12.9051            1            0       4.8211];
% % ms4.vals = [50.1694      12.9051            1            0      4.81031];
% % mts.vals = [58.705      50.0276            1            0      52.6764];
% % sr_mtsj1.vals = [48.88557      148.2204       2.09584  0.0002487586      6.291571];
% % sr_mtsj2.vals = [46.68149      123.0402       2.09584  0.0002487586      0.534141];
% % sr_ms1j2.vals = [52.7208      120.2821      2.100818  0.0002500476      1.004629];
% % c2.vals = [48.9307       1.9651            0      1.42586            0    0.0109365            0     0.263367];
% % c10.vals = [49.3183      9.96357   -0.0100149      1.42586  -0.00163886   0.00725954            0    0.0930538];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];


% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10 --- 82par
% % same length for MS-3/4; same epsilon, tanD for 2 semirigid
% % same epsilon, tanD for c2-c10--- 82 par fixed
% % 
% % r36.vals = [3.62816      17.5167      3.46159      35.9574];
% % r27.vals = [3.59071       17.268      3.63466      26.2414];
% % r69.vals = [3.18514      15.8747      3.05428       70.523];
% % r91.vals = [4.02987      20.1591      2.87744      95.2519];
% % rOpen.vals = [0.899443      56.1191      2.37369     0.997042];
% % rShort.vals = [11.5161      9.56699      16.6005     0.327256];
% % r10.vals = [6.54646      13.6135      28.2518      10.3911];
% % r250.vals = [2.848357      14.54192        1.2818       251.563];
% % rCold.vals = [1.47899      7.86868      1.34697      49.8579];
% % rHot.vals = [3.93693      14.4292      2.40935      50.4967];
% % r25.vals = [3.99996      7.80606      5.62911      23.8633];
% % r100.vals = [1.795783      32.38955      1.596513        104.97];
% % ms1.vals = [54.5911      22.5844            1            0       21.975];
% % ms3.vals = [50.0658      12.9126            1            0      4.86125];
% % ms4.vals = [50.0756      12.9126            1            0      4.84428];
% % mts.vals = [58.9013      48.7078            1            0      52.4402];
% % sr_mtsj1.vals = [48.89684      147.8843      2.106052  0.0002547751      6.958054];
% % sr_mtsj2.vals = [46.72596      122.8071      2.106052  0.0002547751     0.5659663];
% % sr_ms1j2.vals = [52.75955      120.2837       2.10098  0.0002500587      1.003795];
% % c2.vals = [48.942      1.98042            0       1.4262            0   0.00730005            0     0.296103];
% % c10.vals = [49.3333      9.96421   -0.0100188       1.4262  -0.00166171   0.00730005            0    0.0863083];
% % la.vals = [52.383      68.9341         2.05      0.00025      1.03204];

% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10
% % same length for MS-3/4; same epsilon, tanD for 2 semirigid
% % same epsilon, tanD, Rprime for c2-c10--- 81 par fixed
% % 
% r36.vals = [3.62078      17.4713      3.45712      36.0242];
% r27.vals = [3.59167      17.2482      3.67012      26.3409];
% r69.vals = [3.08148       15.342       3.0323      70.3606];
% r91.vals = [3.9322      19.5082       2.8811      94.8314];
% rOpen.vals = [0.933485      56.6936       2.6075      1.00564];
% rShort.vals = [11.6764      10.2432      18.5024     0.327557];
% r10.vals = [7.11975      14.5839      31.2234      10.4035];
% r250.vals = [2.703837      12.53439      1.703731      251.4764];
% rCold.vals = [1.4554      7.63644      1.27865      49.8594];
% rHot.vals = [3.88387      14.2647      2.38312      50.5018];
% r25.vals = [3.68432      7.35389       5.1143       23.805];
% r100.vals = [1.795165      32.37992      1.588229      105.2295];
% ms1.vals = [54.595       22.586            1            0      22.1906];
% ms3.vals = [50.0749      12.9367            1            0      4.88786];
% ms4.vals = [49.8659      12.9367            1            0      4.90908];
% mts.vals = [58.9837      48.5379            1            0      52.2065];
% sr_mtsj1.vals = [48.8957      148.2328      2.100086  0.0002519076      8.023306];
% sr_mtsj2.vals = [46.72186      122.8881      2.100086  0.0002519076     0.5450746];
% sr_ms1j2.vals = [52.73296      120.2986      2.101199  0.0002500659      1.008702];
% c2.vals = [48.9437      1.98113            0      1.42572            0   0.00732876            0    0.0695246];
% c10.vals = [49.327      9.96281   -0.0104823      1.42572  -0.00168382   0.00732876            0    0.0695246];
% la.vals = [52.383      68.9341         2.05      0.00025      1.03204];


% % conv err func.---dB20(rms(mag_dist*cmplx_dist))-----air core (8 par fixed)
% % No epsilon tanD Rprime slope (3 par fixed to zero) for c2 & No Rprime slope c10
% % same length for MS-3/4; same epsilon, tanD, Rprime for 2 semirigid
% % same epsilon, tanD, Rprime for c2-c10--- 80 par fixed
% % 
% r36.vals = [3.67039      17.6662      3.51102      36.1786];
% r27.vals = [3.63117      17.3884       3.6477      26.5833];
% r69.vals = [3.03803      15.1129      3.07012      69.9767];
% r91.vals = [3.83681      18.8007      2.95927       93.857];
% rOpen.vals = [0.916152      56.5776      2.52881      1.00544];
% rShort.vals = [11.4715      10.0135      18.0136     0.328322];
% r10.vals = [6.96422      14.2437      30.3209      10.4018];
% r250.vals = [3.074734      16.67017      1.291853      251.4897];
% rCold.vals = [1.43819      7.72645      1.33497      49.8323];
% rHot.vals = [4.01842      14.6947      2.46594      50.4647];
% r25.vals = [4.26916      7.83809      5.73046      24.1339];
% r100.vals = [1.676284      31.52087      1.588908      103.6581];
% ms1.vals = [54.5738      23.2511            1            0      21.9291];
% ms3.vals = [50.066      12.9442            1            0      4.88728];
% ms4.vals = [50.103      12.9442            1            0       4.9055];
% mts.vals = [58.1865      51.5318            1            0      52.3455];
% sr_mtsj1.vals = [48.88934      147.5848      2.099338  0.0002532312     0.7874216];
% sr_mtsj2.vals = [46.71731      122.7258      2.099338  0.0002532312     0.7874216];
% sr_ms1j2.vals = [52.77929      120.2127      2.100676  0.0002500491      1.000456];
% c2.vals = [48.9308      1.97831            0      1.42555            0    0.0073315            0     0.157727];
% c10.vals = [49.3188      9.96252   -0.0103045      1.42555  -0.00168871    0.0073315            0     0.157727];
% la.vals = [52.383      68.9341         2.05      0.00025      1.03204];
% 
% d1 = REACHcal(dpath,'r36',r36,'r27',r27,'r69',r69,'r91',r91,...
%                 'rOpen',rOpen,'rShort',rShort,'r10',r10,'r250',r250,...
%                 'rCold',rCold,'rHot',rHot,'r25',r25,'r100',r100,...
%                 'c2',c2,'c10',c10,...
%                 'ms1',ms1,'ms3',ms3,'ms4',ms4','mts',mts,...
%                 'sr_mtsj2',sr_mtsj2,'sr_mtsj1',sr_mtsj1,'sr_ms1j2',sr_ms1j2);
% 
% d1.errorFuncType = 'RIA';
% d1.errorFuncNorm = 'mean';
% figure(1)
% d1.plotAllTemperatures('r',leg);hold on;




